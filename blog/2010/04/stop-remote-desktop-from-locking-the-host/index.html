<!DOCTYPE html>
<html lang="en">
  <head>
  
   <meta charset="utf-8">
   <meta http-equiv="X-UA-Compatible" content="IE=edge">
   <meta name="viewport" content="width=device-width, initial-scale=1">
   <meta name="description" content="">
   <meta name="author" content="">
   <link rel="shortcut icon" href="/favicon.ico">

   <title>Adam Jarret - Blog - Stop Remote Desktop from Locking the Host</title>

    <link href="/css/main.css" rel="stylesheet">
    <link href="//maxcdn.bootstrapcdn.com/font-awesome/4.3.0/css/font-awesome.min.css" rel="stylesheet">

    <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
      <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
    <![endif]-->
   
  </head>

  <body class="atj">
  
    <div class="container">
    
      <div class="header">
         <ul class="nav nav-pills pull-right">
            <li class=""><a href="/">Home</a></li>
            <li class="active"><a href="/blog">Blog</a></li>
            <li><a href="https://github.com/adamjarret?tab=repositories">Projects</a></li>
         </ul>
         <h1><a href="/" class="text-muted">Adam Jarret</a></h1>
      </div>

      <div id="blog" class="row">
	<div class="col-md-8">
		<h2><a href="/blog">Blog</a></h2>
		<div class="post-header">
    <h3 class="post-title"><a href="/blog/2010/04/stop-remote-desktop-from-locking-the-host">Stop Remote Desktop from Locking the Host</a></h3>
    <span class="post-date">4 Apr 2010</span> | Tags: <span class="tags">
        
            <a href="/blog/tag/fyi">fyi</a>, 
        
            <a href="/blog/tag/remote-desktop">remote-desktop</a>, 
        
            <a href="/blog/tag/windows">windows</a>
        
    </span>
</div>

<div id="post-/blog/2010/04/stop-remote-desktop-from-locking-the-host" class="post">
    <div class="main-image-container"><a href="/blog/2010/04/stop-remote-desktop-from-locking-the-host"><p><img src="/img/blog/2010/04/rdp_icon-300x294.png" alt="RDP Icon"></p>
</a></div>

<p>Closing a Windows Remote Desktop connection leaves the host machine locked, but it is possible to create a shortcut that will close the session without locking the screen.</p>

<h4>To create the shortcut:</h4>

<ol>
<li><p>Right click on the Desktop and select <strong>New</strong> &rarr; <strong>Shortcut</strong></p>

<p><a href="/img/blog/2010/04/rdp_disconnect_1.png" class="screen-shot" data-lightbox="rdp-disconnect_screen-shots" title="Right click on the Desktop and select New &rarr; Shortcut">
     <img src="/img/blog/2010/04/rdp_disconnect_1-300x209.png" alt="New shortcut dialog screen shot" />
</a></p></li>
<li><p>For <strong>Windows 7/Vista hosts</strong>, enter the following:</p>

<del datetime="2011-09-08T19:11:49+00:00"><code>%windir%\System32\tscon.exe %sessionname% /dest:console</code></del>

<p><span class="post-amendment"><i class="fa fa-exclamation-triangle"></i> <strong>Update</strong>: After a recent system update, using the <code>%sessionname%</code> variable started causing an error. I switched to hard-coding <code>1</code> instead and this has worked so far.</span></p>

<p><code>%windir%\System32\tscon.exe 1 /dest:console</code></p>

<p>For <strong>Windows XP hosts</strong>, enter the following:</p>

<p><code>%windir%\System32\tscon.exe 0 /dest:console</code></p></li>
<li><p>Click <strong>Next</strong>, enter a name for the shortcut and then click <strong>Finish</strong>. The name can be anything you like.</p>

<p><a href="/img/blog/2010/04/rdp_disconnect_2.png" class="screen-shot" data-lightbox="rdp-disconnect_screen-shots" title="Enter a name for the shortcut and then click Finish. The name can be anything you like.">
     <img src="/img/blog/2010/04/rdp_disconnect_2-300x209.png" alt="New shortcut dialog screen shot" />
</a></p></li>
<li><p>On Windows 7/Vista hosts, this shortcut needs to be run with administrator privileges. Right click on the newly created shortcut and select <strong>Properties</strong>.</p></li>
<li><p>Click the <strong>Advanced</strong> button on the Properties window.</p></li>
<li><p>Check the box marked <strong>Run as administrator</strong> and then click <strong>OK</strong>.</p>

<p><a href="/img/blog/2010/04/rdp_disconnect_3.png" class="screen-shot" data-lightbox="rdp-disconnect_screen-shots" title="Check the box marked 'Run as administrator' and then click OK.">
     <img src="/img/blog/2010/04/rdp_disconnect_3-300x202.png" alt="New shortcut dialog screen shot" />
</a></p></li>
</ol>

<p>Pin the shortcut to the Start menu or the taskbar and click it when you would like to disconnect.</p>

</div>


    <div class="comments">
        <h3><i class="fa fa-comments"></i> Comments</h3>
        <div id="comment-36044" class="archived-comment">
  
    <span class="who">Keith</span>
  
  on
  <a href="/blog/2010/04/stop-remote-desktop-from-locking-the-host#comment-36044" class="when">19 Apr 2013 at 2:02 pm</a>
  <blockquote>Thanks soooo much. I looked all over for information to accomplish this. Your solution works great. My only observation is that using this in a network environment when I log in as the actual administrator it works, but when I try to use it as another user who has remote access privileges, the disconnect doesn't seem to work, even though I checked the "Run as Administrator" box. A minor issue at the moment...Thanks again!!</blockquote>
</div>
<div id="comment-39814" class="archived-comment">
  
    <span class="who">PrazAU</span>
  
  on
  <a href="/blog/2010/04/stop-remote-desktop-from-locking-the-host#comment-39814" class="when">21 Aug 2013 at 12:14 am</a>
  <blockquote>This solution work great for me as well. That exactly what I was searching as well.
Thanks heaps

Cheers
Praz</blockquote>
</div>
<div id="comment-63195" class="archived-comment">
  
    <span class="who">Ramesh Tester</span>
  
  on
  <a href="/blog/2010/04/stop-remote-desktop-from-locking-the-host#comment-63195" class="when">26 Feb 2014 at 5:27 am</a>
  <blockquote>Hi Adam,

I have tried with above solution but seems to its not working for me.

I'm using Win 7 machine and prepared shortcut with following command 

C:\Windows\System32\tscon.exe 1 /dest:console

And given a Disconnect as File Name.

I open the remote machine and started automation scripts execution on same machine.

Then I executed the shortcut file "Disconnect" with Administrator rights and it is executed succssfully.

But remote session is not closed, still it is active mode.

Kindly help me on this.</blockquote>
</div>

    </div>


<p>Comments are closed for this post.</p>

<div class="spn-container"><div class="spn-group"><a class="spn-label spn-right" href="/blog/2010/04/debian-beep-at-login-prompt"><i class="fa fa-arrow-circle-right"></i> <b>Next</b></a> <a class="spn spn-right" href="/blog/2010/04/debian-beep-at-login-prompt">Debian: Beep at Login Prompt</a></div><div class="spn-group"><a class="spn-label spn-left" href="/blog/2010/02/google-voice-fluid-ssb"><i class="fa fa-arrow-circle-left"></i> <b>Previous</b></a> <a class="spn spn-left" href="/blog/2010/02/google-voice-fluid-ssb">Google Voice + Fluid (SSB)</a></div></div>

	</div>
	<div class="col-md-4">
		<div class="sidebar">
			<div>
				<script>
				  (function() {
				    var cx = '008188071449344830133:rxk4xlcy2fi';
				    var gcse = document.createElement('script');
				    gcse.type = 'text/javascript';
				    gcse.async = true;
				    gcse.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') +
				        '//www.google.com/cse/cse.js?cx=' + cx;
				    var s = document.getElementsByTagName('script')[0];
				    s.parentNode.insertBefore(gcse, s);
				  })();
				</script>
				<gcse:searchbox-only></gcse:searchbox-only>
			</div>
			<h3><i class="fa fa-rss"></i> <a href="/blog/feed.xml">RSS Feed</a></h3>
			<h3>Latest Posts</h3>
			<ul class="latest-posts">
				
					<li><i class="fa fa-leaf"></i> <a href="/blog/2010/11/write-your-own-coda-plug-in">Write Your Own Coda Plug-In</a></li>
				
					<li><i class="fa fa-leaf"></i> <a href="/blog/2010/04/debian-beep-at-login-prompt">Debian: Beep at Login Prompt</a></li>
				
					<li><i class="fa fa-leaf"></i> <a href="/blog/2010/04/stop-remote-desktop-from-locking-the-host">Stop Remote Desktop from Locking the Host</a></li>
				
					<li><i class="fa fa-leaf"></i> <a href="/blog/2010/02/google-voice-fluid-ssb">Google Voice + Fluid (SSB)</a></li>
				
					<li><i class="fa fa-leaf"></i> <a href="/blog/2010/01/downgrading-to-flash-player-9-on-mac-os-x">Downgrading to Flash Player 9 on Mac OS X</a></li>
				
			</ul>
			<h3>Archive</h3>
			<div class="years"><div class="year"><h4><a href="/blog/2010">2010</a></h4><ul class="months"><li class="month Jan"><a class="month-link" href="/blog/2010/01">January</a></li><li class="month Feb"><a class="month-link" href="/blog/2010/02">February</a></li><li class="month Apr"><a class="month-link" href="/blog/2010/04">April</a></li><li class="month Nov"><a class="month-link" href="/blog/2010/11">November</a></li></ul></div><div class="year"><h4><a href="/blog/2009">2009</a></h4><ul class="months"><li class="month Jan"><a class="month-link" href="/blog/2009/01">January</a></li><li class="month Feb"><a class="month-link" href="/blog/2009/02">February</a></li><li class="month Mar"><a class="month-link" href="/blog/2009/03">March</a></li><li class="month Apr"><a class="month-link" href="/blog/2009/04">April</a></li><li class="month May"><a class="month-link" href="/blog/2009/05">May</a></li><li class="month Jun"><a class="month-link" href="/blog/2009/06">June</a></li><li class="month Aug"><a class="month-link" href="/blog/2009/08">August</a></li><li class="month Oct"><a class="month-link" href="/blog/2009/10">October</a></li><li class="month Nov"><a class="month-link" href="/blog/2009/11">November</a></li><li class="month Dec"><a class="month-link" href="/blog/2009/12">December</a></li></ul></div><div class="year"><h4><a href="/blog/2008">2008</a></h4><ul class="months"><li class="month Sep"><a class="month-link" href="/blog/2008/09">September</a></li><li class="month Oct"><a class="month-link" href="/blog/2008/10">October</a></li><li class="month Nov"><a class="month-link" href="/blog/2008/11">November</a></li></ul></div></div>
		</div>
	</div>
</div>


      <div class="footer blog">
         Copyright &copy; 2016 Adam Jarret
      </div> <!-- /footer -->
           
    </div> <!-- /container -->

    <!-- JavaScript placed at the end of the document so the pages load faster -->
    <script src="http://code.jquery.com/jquery-1.11.0.min.js"></script>
    <script src="/js/vendor/jquery.colorbox.min.js"></script>
    <script src="/js/app/app.js"></script>

  </body>
</html>
